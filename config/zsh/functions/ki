#!/bin/zsh

##? ki - create a new zk idea note with interactive title prompt
##?
##? usage:
##?   ki [--sync-templates]
##?
##? options:
##?   --sync-templates  sync templates before creating note
##?
##? examples:
##?   ki                      # create idea (no sync)
##?   ki --sync-templates     # sync templates, then create idea

ki() {
  [[ "$1" == "-h" || "$1" == "--help" ]] && { grep "^##?" "${(%):-%x}" | cut -c 5-; return 0; }

  local sync_flag=""

  if [[ "$1" == "--sync-templates" ]]; then
    sync_flag="--sync-templates"
  fi

  vared -p "Idea title: " -c idea_title

  idea_title="${idea_title:l}"
  idea_title="${idea_title## ##}"

  if [[ -n "$idea_title" ]]; then
    k $sync_flag new ideas --title "$idea_title"
  else
    echo "Error: Title cannot be empty or only whitespace"
  fi

  unset idea_title
}

# vim: ft=zsh
