#!/bin/zsh

# Start broot and execute the command it produces
# This wrapper function allows broot to affect the parent shell's state (e.g., cd)
# by executing commands in the current shell rather than a subshell.
# The function creates a temporary file where broot writes shell commands,
# then evaluates those commands in the current shell context.
# Usage: br [broot-options] [path]
# Examples:
#   br                    # Start broot in current directory
#   br ~/projects         # Start broot in ~/projects
#   br -h                 # Show broot help

br() {
  local cmd cmd_file code

  cmd_file=$(mktemp)

  if broot --outcmd "$cmd_file" "$@"; then
    cmd=$(<"$cmd_file")
    command rm -f "$cmd_file"
    eval "$cmd"
  else
    code=$?
    command rm -f "$cmd_file"
    return "$code"
  fi
}
