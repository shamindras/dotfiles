#!/bin/zsh
# .zshrc1
# > First things first - start your .zshrc off right
# Project Home: https://github.com/mattmc3/zshrc1

# Init z1
() {
  typeset -g Z1_VERSION="0.0.1"
  typeset -gaH __z1_opts=(extended_glob NO_monitor NO_xtrace NO_ksh_arrays)

  # Add variables for key Zsh directories.
  export __zsh_config_dir=${ZDOTDIR:-${XDG_CONFIG_HOME:-$HOME/.config}/zsh}
  export __zsh_user_data_dir=${XDG_DATA_HOME:-$HOME/.local/share}/zsh
  export __zsh_cache_dir=${XDG_CACHE_HOME:-$HOME/.cache}/zsh

  # Ensure Zsh directories exist.
  local zdir
  for zdir in __zsh_{config,user_data,cache}_dir; do
    [[ -d "${(P)zdir}" ]] || mkdir -p ${(P)zdir}
  done

  # Define Z1 paths
  typeset -g Z1_{COMPLETIONS,CONFIGS,FUNCTION,REPO}_DIR
  typeset -g Z1_{COMPSTYLE,THEME}

  # Directory for Zsh autoload functions.
  zstyle -s ':z1:functions' dir 'Z1_FUNCTION_DIR' \
    || Z1_FUNCTION_DIR=${Z1_FUNCTION_DIR:-$__zsh_config_dir/functions}

  # Directory for cloned Zsh plugin repos.
  zstyle -s ':z1:repos' dir 'Z1_REPO_DIR' \
    || Z1_REPO_DIR=${Z1_REPO_DIR:-$__zsh_cache_dir/repos}

  # Customize with zstyles.
  [[ ! -r $__zsh_config_dir/.zstyles ]] || source $__zsh_config_dir/.zstyles
}

# z1_confd: Source Zsh config files in a conf.d directory.
function z1_confd {
  local confd zfile
  zstyle -s ':z1:configs' dir 'confd' || confd=$__zsh_config_dir/conf.d
  for zfile in $confd/*.zsh(N); do
    [[ ${zfile:t} != '~'* ]] || continue
    source $zfile
  done
}

# Run z1.
() {
  z1_confd # load all z1 functions first
  z1_funcdir
  z1_colorize
  z1_directory
  z1_editor
  z1_history
  z1_utility
  z1_plugins
  z1_completions
}

# vim: ft=zsh 
